Menu="Utilities"
Title="DriveAge"
Icon="icon.png"
---
<?PHP
/* DriveAge Plugin - Dashboard */
require_once '/usr/local/emhttp/plugins/driveage/include/config.php';
require_once '/usr/local/emhttp/plugins/driveage/include/helpers.php';

$config = loadConfig();
$timestamp = date('Y-m-d H:i:s');
?>
<link rel="stylesheet" href="/plugins/driveage/styles/driveage.css">
<script src="/plugins/driveage/js/dashboard.js"></script>

<div class="driveage-container">
    <div class="driveage-header">
        <div>
            <h2>DriveAge - Dashboard</h2>
            <span id="last-updated" class="last-updated">Loading...</span>
        </div>
        <div class="driveage-controls">
            <button id="refresh-btn" title="Refresh drive data">
                <span>↻</span> Refresh
            </button>
            <button onclick="window.location.href='/Settings/DriveAgeSettings'" title="Plugin settings">
                ⚙ Settings
            </button>
        </div>
    </div>

    <!-- Legend Section -->
    <div class="driveage-legend">
        <div class="legend-item">
            <div class="legend-color age-brand_new"></div>
            <span class="legend-label">Brand New</span>
            <span class="legend-hours">(< <?= e(number_format($config['THRESHOLD_BRAND_NEW'])); ?>h)</span>
        </div>
        <div class="legend-item">
            <div class="legend-color age-newish"></div>
            <span class="legend-label">Newish</span>
            <span class="legend-hours">(<?= e(number_format($config['THRESHOLD_BRAND_NEW'])); ?>-<?= e(number_format($config['THRESHOLD_NEWISH'])); ?>h)</span>
        </div>
        <div class="legend-item">
            <div class="legend-color age-normal"></div>
            <span class="legend-label">Normal</span>
            <span class="legend-hours">(<?= e(number_format($config['THRESHOLD_NEWISH'])); ?>-<?= e(number_format($config['THRESHOLD_NORMAL'])); ?>h)</span>
        </div>
        <div class="legend-item">
            <div class="legend-color age-aged"></div>
            <span class="legend-label">Aged</span>
            <span class="legend-hours">(<?= e(number_format($config['THRESHOLD_NORMAL'])); ?>-<?= e(number_format($config['THRESHOLD_AGED'])); ?>h)</span>
        </div>
        <div class="legend-item">
            <div class="legend-color age-old"></div>
            <span class="legend-label">Old</span>
            <span class="legend-hours">(<?= e(number_format($config['THRESHOLD_AGED'])); ?>-<?= e(number_format($config['THRESHOLD_OLD'])); ?>h)</span>
        </div>
        <div class="legend-item">
            <div class="legend-color age-elderly"></div>
            <span class="legend-label">Elderly</span>
            <span class="legend-hours">(≥ <?= e(number_format($config['THRESHOLD_OLD'])); ?>h)</span>
        </div>
    </div>

    <div class="driveage-info">
        <strong>Note:</strong> Elderly drives (≥ <?= e(number_format($config['THRESHOLD_OLD'])); ?>h) are displayed in <strong>bold text</strong> to highlight drives requiring closest monitoring.
    </div>

    <!-- Drive data container (will be populated by JavaScript) -->
    <div id="drive-container"></div>

    <!-- Footer Section -->
    <div class="driveage-footer">
        <span id="drive-count">Total Drives: 0</span> |
        DriveAge v2025.11.27 |
        <a href="/Settings/DriveAgeSettings">Settings</a>
    </div>
</div>

