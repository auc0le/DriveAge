Menu="Utilities"
Title="DriveAge"
Icon="icon.png"
---
<?PHP
/* DriveAge Plugin
 * Drive Age Monitor Dashboard
 */
?>
<?
require_once '/usr/local/emhttp/plugins/driveage/include/config.php';
require_once '/usr/local/emhttp/plugins/driveage/include/helpers.php';

// Load configuration
$config = loadConfig();
?>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/plugins/driveage/styles/driveage.css">
    <script src="/plugins/driveage/js/dashboard.js"></script>
</head>
<body>
    <div class="driveage-container">
        <!-- Header Section -->
        <div class="driveage-header">
            <div>
                <h2>DriveAge - Dashboard</h2>
                <span id="last-updated" class="last-updated">Loading...</span>
            </div>
            <div class="driveage-controls">
                <button id="refresh-btn" title="Refresh drive data">
                    <span>↻</span> Refresh
                </button>
                <div class="view-toggle">
                    <button id="view-table-btn" class="active" title="Table view">
                        ☰ Table
                    </button>
                    <button id="view-card-btn" title="Card view">
                        ▦ Cards
                    </button>
                </div>
                <button onclick="window.location.href='/Settings/DriveAgeSettings'" title="Plugin settings">
                    ⚙ Settings
                </button>
            </div>
        </div>

        <!-- Legend Section -->
        <div class="driveage-legend">
            <div class="legend-item">
                <div class="legend-color age-brand_new"></div>
                <span class="legend-label">Brand New</span>
                <span class="legend-hours">(< <?<? e(number_format($config['THRESHOLD_BRAND_NEW'])); ?>h)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color age-newish"></div>
                <span class="legend-label">Newish</span>
                <span class="legend-hours">(<?<? e(number_format($config['THRESHOLD_BRAND_NEW'])); ?>-<?<? e(number_format($config['THRESHOLD_NEWISH'])); ?>h)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color age-normal"></div>
                <span class="legend-label">Normal</span>
                <span class="legend-hours">(<?<? e(number_format($config['THRESHOLD_NEWISH'])); ?>-<?<? e(number_format($config['THRESHOLD_NORMAL'])); ?>h)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color age-aged"></div>
                <span class="legend-label">Aged</span>
                <span class="legend-hours">(<?<? e(number_format($config['THRESHOLD_NORMAL'])); ?>-<?<? e(number_format($config['THRESHOLD_AGED'])); ?>h)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color age-old"></div>
                <span class="legend-label">Old</span>
                <span class="legend-hours">(<?<? e(number_format($config['THRESHOLD_AGED'])); ?>-<?<? e(number_format($config['THRESHOLD_OLD'])); ?>h)</span>
            </div>
            <div class="legend-item">
                <div class="legend-color age-elderly"></div>
                <span class="legend-label">Elderly</span>
                <span class="legend-hours">(≥ <?<? e(number_format($config['THRESHOLD_OLD'])); ?>h)</span>
            </div>
        </div>

        <div class="driveage-info">
            <strong>Note:</strong> Drives with the highest power-on hours are displayed in <strong>bold text</strong> to highlight drives requiring closest monitoring.
        </div>

        <!-- Drive Display Section -->
        <div id="drive-display">
            <div class="driveage-loading">
                <div class="spinner"></div> Loading drive data...
            </div>
        </div>

        <!-- Footer Section -->
        <div class="driveage-footer">
            <span id="drive-count">Total Drives: 0</span> |
            DriveAge v2025.11.26 |
            <a href="/Settings/DriveAgeSettings">Settings</a>
        </div>
    </div>
</body>
</html>
